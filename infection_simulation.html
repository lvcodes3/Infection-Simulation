<!-- All code below written by Luis Valencia -->
<!DOCTYPE html>
<html>
    <head>
        <title>Infection Simulation</title>
        <meta charset="UTF-8"/>
        <style>
            #buttons{
                text-align: center;
            }
            #image-grid{
                text-align: center;
                margin: auto;
                /*border: 1px solid black;*/
            }
            table{
                border-collapse: collapse;
                table-layout: fixed;
                margin: auto;
                width: 700px;
                height: 700px;
            }
            td{
                /*uncomment to show interactive grid*/
                /*border: 1px solid black;*/
                width: calc(100%/100);
                height: calc(100%/100);
                overflow: hidden; 

            }
            #info{
                float: right;
            }
            #time{
                float: left;
            }
            #main{
                max-width: 1000px;
                text-align: center;
                margin: auto;
            }
        </style>

        <script src="https://cdn.plot.ly/plotly-2.11.1.min.js"></script>
        

    </head>
    <body onload="displayGrid();countPeople();">
        <div id="buttons">
            <button id="testing" onclick="gameLoop()">Begin Simulation</button>
        </div>

        <div id="main">
            <div id="time">

            </div>

            <div id="info">
                <h3 id="numUninfected"></h3>
                <h3 id="numInfected"></h3>
            </div>

            <div id="image-grid">

            </div>
        </div>

        <div id="dataPlot" style="width:1000px;height:700px;"></div>
            

        <!-- Functionality for the infection simulation -->
        <script>
            // GLOBALS:

            // number of times you want the simulation to run
            let xNum = 1;

            // keeps track of total people on the grid
            let peopleCount = 0;

            // keeps track of infected people on the grid, used for data collection
            let infectedPeople = 0;

            // starting time step, 0, each movePeople() or checkInfection() is 1 step, used for data collection
            let timeStep = 0;

            // seed used for placement of initial infected person on the grid
            let seed = Math.floor(Math.random() * 215);

            // array used to collect timeStep of each simulation run
            let timeStepCollection = [];
            for (let i = 0; i < xNum; i++){
                timeStepCollection[i] = [];
            }

            // array used to collect infectedPeople at each single timeStep
            let infectedPeopleCollection = [];
            for (let i = 0; i < xNum; i++){
                infectedPeopleCollection[i] = [];
            }

            // class of cell
            class Cell{
                empty;
                uninfected;
                infected;
                moved;
                roundsInfected;

                constructor(){
                    // generating random variables (0-99)
                    let random1 = Math.floor(Math.random() * 100);
                    let random2 = Math.floor(Math.random() * 100);

                    // single instance cell of infected placed; will always be randomized due
                    // to randomization variables
                    if(peopleCount == seed){
                        this.infected = true;
                        this.uninfected = false;
                        this.empty = false;
                        this.moved = false;
                        this.roundsInfected = 1;
                        peopleCount++;
                    }
                    // 17 percent chance of inserting an empty cell
                    else if(random1 < 17 && peopleCount < 240){
                        this.empty = true;
                        this.infected = false;
                        this.uninfected = false;
                        this.moved = false;
                        this.roundsInfected = 0;
                    }
                    // 69 percent chance of inserting a person cell
                    else if (random2 < 69 && peopleCount < 240){
                        this.uninfected = true;
                        this.infected = false;
                        this.empty = false;
                        this.moved = false;
                        this.roundsInfected = 0;
                        peopleCount++;
                    }
                    // if above conditions not satisfied then insert an empty cell
                    else{
                        this.empty = true;
                        this.infected = false;
                        this.uninfected = false;
                        this.moved = false;
                        this.roundsInfected = 0;
                    }
                }
            }

            // for visual display on grid
            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            // if we do not meet people requirement, then we will physically add some
            let insertMorePeople = () =>{
                for (let i = 19; i > 0; i--){
                    if (peopleCount == 240){
                            break;
                    }
                    for (let j = 19; j > 0; j-=2){
                        if (cells[i][j].empty == true){
                            cells[i][j].uninfected = true;
                            cells[i][j].empty = false;
                            cells[i][j].infected = false;
                            peopleCount++;
                        }
                        if (peopleCount == 240){
                            break;
                        }
                    }
                }
            }

            // for debugging purposes
            let outputAttr = () =>{
                for (let i = 0; i < 20; i++){
                    for (let j = 0; j < 20; j++){
                        
                        console.log("Empty: " + cells[i][j].empty);
                        console.log("Infected: " + cells[i][j].infected);
                        console.log("Uninfected: " + cells[i][j].uninfected);
                        console.log("Moved: " + cells[i][j].moved);
                        console.log("Rounds Infected: " + cells[i][j].roundsInfected);
                        console.log(" ");
                    }
                }
            }

            // reset all moved attributes to false, for movement purposes
            let resetMoved = () =>{
                for (let i = 0; i < 20; i++){
                    for (let j = 0; j < 20; j++){
                        cells[i][j].moved = false;
                    }
                }
            }

            // counting our region for display purposes
            let countPeople = () =>{
                // local vars
                let normal = 0;
                let sick = 0;

                // counting each single cell instance
                for (let i = 0; i < 20; i++){
                    for (let j = 0; j < 20; j++){
                        if (cells[i][j].infected == true){
                            sick += 1;
                        }
                        else if (cells[i][j].uninfected== true){
                            normal += 1;
                        }
                    }
                }

                // updating html file for display purposes
                document.getElementById("numUninfected").innerHTML = "Uninfected: " + normal;
                document.getElementById("numInfected").innerHTML = "Infected: " + sick;
            }

            // for infection purposes
            let setRounds = () =>{
                for (let i = 0; i < 20; i++){
                    for (let j = 0; j < 20; j++){
                        if (cells[i][j].infected == true){
                            cells[i][j].roundsInfected = 1;
                        }
                    }
                }
            }

            // helper function to let us check all surroundings of a cell, even when out of bounds
            let outOfBounds = (row, col) =>{
                let height = 20;
                let width = 20;

                // if input row or col are out of bounds return true
                if ( (row >= height || row <0)  || (col >= width || col < 0)) {
                    return true;
                }
                else{
                    return false;
                }
            }

            // counting number of infected people
            let countInfectedPeople = () =>{
                let infected = 0;

                for (let i = 0; i < 20; i++){

                    for (let j = 0; j < 20; j++){
                        if (cells[i][j].infected == true){
                            infected++;
                        }
                    }
                }
                return infected;
            }

            // loop to find infected cells, then spread infection
            // visual demonstration display: await sleep (300);
            // data collection purposes: await sleep(0.2);
            async function checkInfections(){
                let counter = 0;

                for (let i = 0; i < 20; i++){

                    for (let j = 0; j < 20; j++){

                        // if infected cell is found, then proceed to determine where it is
                        if (cells[i][j].infected == true && cells[i][j].roundsInfected == 1){
                            // diagonal top left
                            if (outOfBounds(i-1, j-1) == false && cells[i-1][j-1].uninfected == true){
                                cells[i-1][j-1].uninfected = false;
                                cells[i-1][j-1].infected = true;
                                document.getElementById(counter - 21).children[0].src = "./images/infected.png";
                                await sleep (0.2);
                            }
                            // top
                            if (outOfBounds(i-1, j) == false && cells[i-1][j].uninfected == true){
                                cells[i-1][j].uninfected = false;
                                cells[i-1][j].infected = true;
                                document.getElementById(counter - 20).children[0].src = "./images/infected.png";
                                await sleep (0.2);
                            }
                            // diagonal top right
                            if (outOfBounds(i-1, j+1) == false && cells[i-1][j+1].uninfected == true){
                                cells[i-1][j+1].uninfected = false;
                                cells[i-1][j+1].infected = true;
                                document.getElementById(counter - 19).children[0].src = "./images/infected.png";
                                await sleep (0.2);
                            }
                            // left
                            if (outOfBounds(i, j-1) == false && cells[i][j-1].uninfected == true){
                                cells[i][j-1].uninfected = false;
                                cells[i][j-1].infected = true;
                                document.getElementById(counter - 1).children[0].src = "./images/infected.png";
                                await sleep (0.2);
                            }
                            // right
                            if (outOfBounds(i, j+1) == false && cells[i][j+1].uninfected == true){
                                cells[i][j+1].uninfected = false;
                                cells[i][j+1].infected = true;
                                document.getElementById(counter + 1).children[0].src = "./images/infected.png";
                                await sleep (0.2);
                            }
                            // diagonal bottom left
                            if (outOfBounds(i+1, j-1) == false && cells[i+1][j-1].uninfected == true){
                                cells[i+1][j-1].uninfected = false;
                                cells[i+1][j-1].infected = true;
                                document.getElementById(counter + 19).children[0].src = "./images/infected.png";
                                await sleep (0.2);
                            }
                            // bottom
                            if (outOfBounds(i+1, j) == false && cells[i+1][j].uninfected == true){
                                cells[i+1][j].uninfected = false;
                                cells[i+1][j].infected = true;
                                document.getElementById(counter + 20).children[0].src = "./images/infected.png";
                                await sleep (0.2);
                            }
                            // diagonal bottom right
                            if (outOfBounds(i+1, j+1) == false && cells[i+1][j+1].uninfected == true){
                                cells[i+1][j+1].uninfected = false;
                                cells[i+1][j+1].infected = true;
                                document.getElementById(counter + 21).children[0].src = "./images/infected.png";
                                await sleep (0.2);
                            }
                            // update people count visual, after infection done
                            countPeople();
                        }
                        counter++;
                    }
                }
                // sets all infected cells attribute, roundsInfected = 1
                setRounds();
            }

            // loop to move each person on the map, only once, won't move if stuck between by people on all 8 block sides
            // visual demonstration display: await sleep (0.60);
            // data collection purposes: await sleep(0.1);
            async function movePeople(){
                let counter = 0; 

                for (let i = 0; i < 20; i++){

                    for (let j = 0; j < 20; j++){

                        let randomVar = Math.floor(Math.random() * 8);

                        if (randomVar < 4){

                            // moving normal or sick people around the map
                            if (cells[i][j].empty == false && cells[i][j].moved == false){
                            
                                // if diagonal top left cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                if (outOfBounds(i-1, j-1) == false && cells[i-1][j-1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter - 21).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter - 21).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i-1][j-1].empty = false;
                                    cells[i-1][j-1].uninfected = cells[i][j].uninfected;
                                    cells[i-1][j-1].infected = cells[i][j].infected;
                                    cells[i-1][j-1].moved = true;
                                    cells[i-1][j-1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if top cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i-1, j) == false && cells[i-1][j].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter - 20).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter - 20).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i-1][j].empty = false;
                                    cells[i-1][j].uninfected = cells[i][j].uninfected;
                                    cells[i-1][j].infected = cells[i][j].infected;
                                    cells[i-1][j].moved = true;
                                    cells[i-1][j].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if diagonal top right cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i-1, j+1) == false && cells[i-1][j+1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter - 19).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter - 19).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i-1][j+1].empty = false;
                                    cells[i-1][j+1].uninfected = cells[i][j].uninfected;
                                    cells[i-1][j+1].infected = cells[i][j].infected;
                                    cells[i-1][j+1].moved = true;
                                    cells[i-1][j+1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if left cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i, j-1) == false && cells[i][j-1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter - 1).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{

                                        document.getElementById(counter - 1).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i][j-1].empty = false;
                                    cells[i][j-1].uninfected = cells[i][j].uninfected;
                                    cells[i][j-1].infected = cells[i][j].infected;
                                    cells[i][j-1].moved = true;
                                    cells[i][j-1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if right cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i, j+1) == false && cells[i][j+1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter + 1).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter + 1).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i][j+1].empty = false;
                                    cells[i][j+1].uninfected = cells[i][j].uninfected;
                                    cells[i][j+1].infected = cells[i][j].infected;
                                    cells[i][j+1].moved = true;
                                    cells[i][j+1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if diagonal bottom left cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i+1, j-1) == false && cells[i+1][j-1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter + 19).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{

                                        document.getElementById(counter + 19).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i+1][j-1].empty = false;
                                    cells[i+1][j-1].uninfected = cells[i][j].uninfected;
                                    cells[i+1][j-1].infected = cells[i][j].infected;
                                    cells[i+1][j-1].moved = true;
                                    cells[i+1][j-1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if bottom cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i+1, j) == false && cells[i+1][j].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter + 20).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter + 20).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i+1][j].empty = false;
                                    cells[i+1][j].uninfected = cells[i][j].uninfected;
                                    cells[i+1][j].infected = cells[i][j].infected;
                                    cells[i+1][j].moved = true;
                                    cells[i+1][j].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if diagonal bottom right cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i+1, j+1) == false && cells[i+1][j+1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter + 21).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter + 21).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i+1][j+1].empty = false;
                                    cells[i+1][j+1].uninfected = cells[i][j].uninfected;
                                    cells[i+1][j+1].infected = cells[i][j].infected;
                                    cells[i+1][j+1].moved = true;
                                    cells[i+1][j+1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }
                            }
                        }

                        else if (randomVar >= 4){

                            // moving normal or sick people around the map
                            if (cells[i][j].empty == false && cells[i][j].moved == false){

                                // if diagonal bottom right cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                if (outOfBounds(i+1, j+1) == false && cells[i+1][j+1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter + 21).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter + 21).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i+1][j+1].empty = false;
                                    cells[i+1][j+1].uninfected = cells[i][j].uninfected;
                                    cells[i+1][j+1].infected = cells[i][j].infected;
                                    cells[i+1][j+1].moved = true;
                                    cells[i+1][j+1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if bottom cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i+1, j) == false && cells[i+1][j].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter + 20).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter + 20).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i+1][j].empty = false;
                                    cells[i+1][j].uninfected = cells[i][j].uninfected;
                                    cells[i+1][j].infected = cells[i][j].infected;
                                    cells[i+1][j].moved = true;
                                    cells[i+1][j].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if diagonal bottom left cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i+1, j-1) == false && cells[i+1][j-1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter + 19).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{

                                        document.getElementById(counter + 19).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i+1][j-1].empty = false;
                                    cells[i+1][j-1].uninfected = cells[i][j].uninfected;
                                    cells[i+1][j-1].infected = cells[i][j].infected;
                                    cells[i+1][j-1].moved = true;
                                    cells[i+1][j-1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if right cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i, j+1) == false && cells[i][j+1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter + 1).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter + 1).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i][j+1].empty = false;
                                    cells[i][j+1].uninfected = cells[i][j].uninfected;
                                    cells[i][j+1].infected = cells[i][j].infected;
                                    cells[i][j+1].moved = true;
                                    cells[i][j+1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if left cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i, j-1) == false && cells[i][j-1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter - 1).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{

                                        document.getElementById(counter - 1).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i][j-1].empty = false;
                                    cells[i][j-1].uninfected = cells[i][j].uninfected;
                                    cells[i][j-1].infected = cells[i][j].infected;
                                    cells[i][j-1].moved = true;
                                    cells[i][j-1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if diagonal top right cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i-1, j+1) == false && cells[i-1][j+1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter - 19).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter - 19).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i-1][j+1].empty = false;
                                    cells[i-1][j+1].uninfected = cells[i][j].uninfected;
                                    cells[i-1][j+1].infected = cells[i][j].infected;
                                    cells[i-1][j+1].moved = true;
                                    cells[i-1][j+1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if top cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i-1, j) == false && cells[i-1][j].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter - 20).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter - 20).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i-1][j].empty = false;
                                    cells[i-1][j].uninfected = cells[i][j].uninfected;
                                    cells[i-1][j].infected = cells[i][j].infected;
                                    cells[i-1][j].moved = true;
                                    cells[i-1][j].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }

                                // if diagonal top left cell is in bounds of the grid and happens to be an empty cell, swap current person into that cell
                                else if (outOfBounds(i-1, j-1) == false && cells[i-1][j-1].empty == true){

                                    // updating visual display
                                    if (cells[i][j].infected == true){
                                        document.getElementById(counter - 21).children[0].src = "./images/infected.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }
                                    else{
                                        document.getElementById(counter - 21).children[0].src = "./images/player.png";
                                        document.getElementById(counter).children[0].src = "./images/empty.png";
                                    }

                                    // updating interactive grid
                                    // updating new housing cell for old cell
                                    cells[i-1][j-1].empty = false;
                                    cells[i-1][j-1].uninfected = cells[i][j].uninfected;
                                    cells[i-1][j-1].infected = cells[i][j].infected;
                                    cells[i-1][j-1].moved = true;
                                    cells[i-1][j-1].roundsInfected = cells[i][j].roundsInfected;

                                    // updating old cell (new empty cell)
                                    cells[i][j].empty = true;
                                    cells[i][j].uninfected = false;
                                    cells[i][j].infected = false;
                                    cells[i][j].moved = false;
                                    cells[i][j].roundsInfected = 0;

                                    await sleep (0.1);
                                }
                            }   
                        }

                        // updating counter
                        counter++;
                    }
                }

                // resetting moved attribute for next iteration of moving
                resetMoved();
            }

            // loop to visual simulation process
            async function gameLoop(){

                // run the simulation xNum of times to log data
                for (let i = 0; i < xNum; i++){
                    
                    // loop until all people are infected
                    while (countInfectedPeople() != 240){

                        document.getElementById("time").innerHTML = "Time Step: " + timeStep;

                        // log data
                        timeStepCollection[i].push(timeStep);
                        infectedPeopleCollection[i].push(countInfectedPeople());

                        const step1 = await checkInfections();
                        timeStep++;

                        timeStepCollection[i].push(timeStep);
                        infectedPeopleCollection[i].push(countInfectedPeople());

                        document.getElementById("time").innerHTML = "Time Step: " + timeStep;

                        if(countInfectedPeople() == 240) break;

                        const step2 = await movePeople();
                        timeStep++;

                    }

                    const testing = await resetEntireSimulation();
                    
                }

                // displaying plot of data collected from running simulation
                plotData();
                
            }

            // visually displaying the 20 x 20 grid in the HTML page
            let displayGrid = () => {
                //html table representing the grid
                let html = "<table id=\"interactive\">";
                let innerCounter = 0;
                for(let i = 0; i < 20; i++) {
                    html += "<tr>";
                    
                    for(let j = 0; j < 20; j++){

                        if(cells[i][j].empty == true){
                            html += "<td id=" + innerCounter + "><img src=\"\"></td>";
                        }
                        else{
                            if(cells[i][j].uninfected == true){
                                html += "<td id=" + innerCounter + "><img src=\"./images/player.png\"></td>";
                            }
                            else{
                                html += "<td id=" + innerCounter + "><img src=\"./images/infected.png\"></td>";
                            }
                        }
                        innerCounter++;
                    }

                    html += "</tr>";
                }
                html += "</table>";
                document.getElementById("image-grid").innerHTML = html;
            }

            /* 
               CREATING 2D ARRAY WITH CELL INSTANCES
               2d array will hold all instances of cells in the interactive grid
               20 x 20 grid size
            */
            let cells = [];
            for (let i = 0; i < 20; i++){
                cells[i] = [];
                for (let j = 0; j < 20; j++){
                        cells[i][j] = new Cell();
                        //console.log(cells[i][j].infected);
                }
            }
            // making sure we meet people size requirements
            if (peopleCount != 240){
                insertMorePeople();
            }


            // resetting simulation, used for data collection purposes
            async function resetEntireSimulation(){
                // keeps track of total people on the grid
                peopleCount = 0;

                // keeps track of infected people on the grid, used for data collection
                infectedPeople = 0;

                // starting time step, 0, each movePeople() or checkInfection() is 1 step, used for data collection
                timeStep = 0;

                // seed used for placement of initial infected person on the grid
                seed = Math.floor(Math.random() * 215);

                // resetting interactive 2d array
                cells = [];
                for (let i = 0; i < 20; i++){
                    cells[i] = [];
                    for (let j = 0; j < 20; j++){
                        cells[i][j] = new Cell();
                    }
                }
                // making sure we meet people size requirements
                if (peopleCount != 240){
                    insertMorePeople();
                }

                displayGrid(); 

                countPeople();
            }
            
            // brute force way (easy for the 10 running simulations)
            let plotData = () =>{

                // inserting data into tempArr
                var tempArr = [];
                for (let i = 0; i < xNum; i++){
                    tempArr[i] = {
                        x: timeStepCollection[i],
                        y: infectedPeopleCollection[i],
                        mode: "markers",
                        type: "scatter"
                    }
                }
                
                var data = [];
                for (let i = 0; i < tempArr.length; i++){
                    data.push(tempArr[i]);
                }

                Plotly.newPlot("dataPlot", data);

            }
        </script>
    </body>
</html>